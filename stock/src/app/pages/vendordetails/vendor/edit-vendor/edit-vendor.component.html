<div class="col-md-12">
  <nb-card>
    <nb-card-header>Edit Stock Details</nb-card-header>
    <nb-card-body>
      <form [formGroup]="editvendor" class="form-horizontal" (ngSubmit)="editstockIn()">
        <div class="modal-body">
          <nb-tabset>
            <nb-tab tabTitle="Stock Details">
              <div class="modal-body">
                <div class="form-group row">
                  <div class="col-sm-6">
                    <label>
                      Select Business <span style="color: red">*</span></label>
                    <auto-completen [addclass]="{
                        error: submit && this.editvendor.controls.bid.errors
                      }" addclass="form-control" optValues="bname" formControlName="bid" (keyUp)="getbusiness($event)"
                      placeholder="Select Business" Id="id" [item]="getbusines1">
                    </auto-completen>
                    <div *ngIf="
                        this.editvendor.controls.bid.errors &&
                        this.editvendor.controls.bid.errors.required &&
                        submit
                      " class="error-text">
                      State Name is required!
                    </div>
                  </div>
                </div>

                <div class="form-group row">
                  <div class="col-sm-6">
                    <label>Vendor Company<span style="color: red">*</span></label>
                    <input type="text" class="form-control" name="vcompany" formControlName="vcompany"
                      placeholder="Enter Vendor Name" [ngClass]="{
                        'is-invalid':
                          submit && editvendor.controls.vcompany.errors
                      }" />
                    <small *ngIf="
                        editvendor.controls.vcompany.errors &&
                        editvendor.controls.vcompany.errors.required &&
                        submit
                      " class="invalid-feedback">Vendor Name is required!
                    </small>
                  </div>

                  <div class="col-sm-6">
                    <label>
                      Vendor Name <span style="color: red">*</span></label>
                    <input type="text" class="form-control" name="vname" formControlName="vname"
                      placeholder="Enter Vendor Name" [ngClass]="{
                        'is-invalid': submit && editvendor.controls.vname.errors
                      }" />
                    <small *ngIf="
                        editvendor.controls.vname.errors &&
                        editvendor.controls.vname.errors.required &&
                        submit
                      " class="invalid-feedback">Vendor Name is required!
                    </small>
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-sm-6">
                    <label>
                      Vendor Mobile No <span style="color: red">*</span></label>
                    <input type="number" class="form-control" name="vmobile" formControlName="vmobile"
                      placeholder="Enter Vendor Name" [ngClass]="{
                        'is-invalid':
                          submit && editvendor.controls.vmobile.errors
                      }" />
                    <small *ngIf="
                        editvendor.controls.vmobile.errors &&
                        editvendor.controls.vmobile.errors.required &&
                        submit
                      " class="invalid-feedback">Vendor Name is required!
                    </small>
                  </div>
                  <div class="col-sm-6">
                    <label>Vendor Email<span style="color: red">*</span></label>
                    <input type="text" class="form-control" name="vmail" formControlName="vmail"
                      placeholder="Enter Vendor Name" [ngClass]="{
                        'is-invalid': submit && editvendor.controls.vmail.errors
                      }" />
                    <small *ngIf="
                        editvendor.controls.vmail.errors &&
                        editvendor.controls.vmail.errors.required &&
                        submit
                      " class="invalid-feedback">Vendor Name is required!
                    </small>
                  </div>
                </div>
              </div>
            </nb-tab>

            <nb-tab tabTitle="Bank Details ">
              <div class="modal-body">
                <div class="form-group row" formArrayName="bankdetails">
                  <div class="col-sm-12">
                    <div *ngFor="
                        let user of bankdetails.controls;
                        index as idx;
                        let last = last
                      ">
                      <div class="row" [formGroupName]="idx">
                         <div class="form-group" class="col-sm-2">
                          <label>Bank Details <span style="color: red">*</span></label>
                          <auto-completen   
                          [addclass]="{error:submit &&  this.user['controls']['bank'].invalid && submit}"
                            addclass="form-control"
                         optValues="bname" formControlName="bank" (keyUp)="getbanf()" placeholder="Select Bank" Id="id" [item]="banklist1">
                          </auto-completen>
                      <small *ngIf="user.hasError('required','bank')&&submit" class="error-text"> Bank Details is Required! </small> 
                      </div>
                        <div class="form-group" class="col-sm-2">
                          <label>Bank Name <span style="color: red">*</span></label>
                          <input [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['vbname'].invalid && submit
                            }" type="text" name="vbname" formControlName="vbname" placeholder="Enter Invoice No"
                            class="form-control" />
                          <small *ngIf="
                              user.hasError('required', 'vbname') && submit
                            " class="error-text">
                            Gst No is Required!
                          </small>
                        </div>
                        <div class="form-group" class="col-sm-2">
                          <label>
                            Bank NO <span style="color: red">*</span></label>
                          <input [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['vbacctno'].invalid && submit
                            }" type="text" name="vbacctno" formControlName="vbacctno"
                            placeholder="Enter Vendor Bank No" class="form-control" />
                          <small *ngIf="
                              user.hasError('required', 'vbacctno') && submit
                            " class="error-text">
                            Gst No is Required!
                          </small>
                        </div>

                        <div class="form-group" class="col-sm-2">
                          <label>Bank IFSC <span style="color: red">*</span></label>
                          <input [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['vbifsc'].invalid && submit
                            }" type="text" name="vbifsc" formControlName="vbifsc"
                            placeholder="Enter Vendor Bank IFSC No" class="form-control" />
                          <small *ngIf="
                              user.hasError('required', 'vbifsc') && submit
                            " class="error-text">
                            Gst No is Required!
                          </small>
                        </div>
                        <div class="form-group" class="col-sm-2" *ngIf="idx < count">
                          <div *ngIf="id">
                            <label>Status<span style="color: red">*</span></label>
                            <select [ngClass]="{
                                'form-control': true,
                                'form-control-danger':
                                  user['controls']['vbstatus'].invalid && submit
                              }" class="form-control" (change)="Removestring($event)" name="vbstatus"
                              formControlName="vbstatus" type="number">
                              <option value="" selected>Select Status</option>
                              <option value="1">Active</option>
                              <option value="0">Deactive</option>
                            </select>
                            <small *ngIf="
                                user.hasError('required', 'vbstatus') && submit
                              " class="error-text">
                              Gst No is Required!
                            </small>
                          </div>
                        </div>
                        <div class="form-group" class="col-sm-1" *ngIf="last">
                          <div class="btn-group">
                            <button type="button" style="margin-top: 31%" class="btn btn-md btn-success dropdown-toggle"
                              data-bs-toggle="dropdown">
                              Action
                            </button>
                            <div class="dropdown-menu">
                              <a (click)="deleteBankdetails(idx)" class="dropdown-item" *ngIf="
                                  idx != 0 && idx != count - 1 && last == true
                                "><i title="Edit Complaint" class="ion-android-delete"></i>&nbsp;Delete</a>
                              <a (click)="addBankdetails()" class="dropdown-item" *ngIf="last"><i title="Edit Complaint"
                                  class="ion-ios-plus-outline"></i>&nbsp;ADD
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </nb-tab>

            <nb-tab tabTitle="Address Details ">
              <div class="modal-body">
                <div class="form-group row" formArrayName="stockinid">
                  <div *ngFor="
                      let user of stockinid.controls;
                      index as idx;
                      let last = last
                    ">
                    <div class="col-sm-12">
                      <div class="row" [formGroupName]="idx">
                        <div class="form-group" class="col-sm-3">
                          <label>GST NO<span style="color: red">*</span></label>
                          <input [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['gstno'].invalid && submit
                            }" type="text" name="gstno" formControlName="gstno" placeholder="Enter GST NO"
                            class="form-control" />
                          <small *ngIf="user.hasError('required', 'gstno') && submit" class="error-text">
                            Gst No is Required!
                          </small>
                        </div>

                        <div class="form-group" class="col-sm-3">
                          <label>
                            Short Address
                            <span style="color: red">*</span></label>
                          <textarea [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['addresname'].invalid && submit
                            }" type="text" name="addresname" formControlName="addresname"
                            placeholder="Enter Address Details" class="form-control">
                          </textarea>

                          <small *ngIf="
                              user.hasError('required', 'addresname') && submit
                            " class="error-text">
                            Address name is Required!
                          </small>
                        </div>
                        <div class="form-group" class="col-sm-3">
                          <label>State<span style="color: red">*</span></label>
                          <auto-completen [addclass]="{
                              error:
                                submit &&
                                this.user['controls']['state'].invalid &&
                                submit
                            }" addclass="form-control" optValues="state_name" formControlName="state"
                            (keyUp)="getstate($event)" (changed)="
                              getdistrict(); dropdown($event); changestate(idx)
                            " placeholder="Select State" optId="state_pk" [item]="getstates">
                          </auto-completen>
                          <small *ngIf="user.hasError('required', 'state') && submit" class="error-text">state is
                            Required!
                          </small>
                        </div>

                        <div class="form-group" class="col-sm-3">
                          <label>District<span style="color: red">*</span></label>
                          <auto-completen [addclass]="{
                              error:
                                submit &&
                                this.user['controls']['district'].invalid &&
                                submit
                            }" addclass="form-control" optValues="district_name" formControlName="district"
                            (keyUp)="getdistrict($event)" placeholder="Select District" optId="district_pk"
                            [item]="dist">
                          </auto-completen>
                          <small *ngIf="
                              user.hasError('required', 'district') && submit
                            " class="error-text">District is Required!
                          </small>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-12">
                      <div class="row" [formGroupName]="idx">
                        <div class="form-group" class="col-sm-3">
                          <label>Pincode<span style="color: red">*</span></label>
                          <input [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['pincode'].invalid && submit
                            }" type="text" name="pincode" formControlName="pincode" placeholder="Enter Pincode"
                            class="form-control" />

                          <small *ngIf="
                              user.hasError('required', 'pincode') && submit
                            " class="error-text">
                            Pincode is Required!
                          </small>
                        </div>

                        <div class="form-group" class="col-sm-3">
                          <label>
                            Full Address
                            <span style="color: red">*</span></label>
                          <textarea [ngClass]="{
                              'form-control': true,
                              'form-control-danger':
                                user['controls']['address'].invalid && submit
                            }" type="text" class="form-control" name="address" formControlName="address"
                            placeholder="Enter Address Details">
                          </textarea>

                          <small *ngIf="
                              user.hasError('required', 'address') && submit
                            " class="error-text">
                            Address is Required!
                          </small>
                        </div>

                        <div class="form-group" class="col-sm-3" *ngIf="idx < count1">
                          <div *ngIf="id">
                            <label>Status<span style="color: red">*</span></label>
                            <select [ngClass]="{
                                'form-control': true,
                                'form-control-danger':
                                  user['controls']['vastatus'].invalid && submit
                              }" class="form-control" name="vastatus" formControlName="vastatus" type="number">
                              <option value="" selected>Select Status</option>
                              <option value="1">Active</option>
                              <option value="0">Deactive</option>
                            </select>
                            <small *ngIf="
                                user.hasError('required', 'vastatus') && submit
                              " class="error-text">
                              Status is Required!
                            </small>
                          </div>
                        </div>
                        <div class="form-group" class="col-sm-1" *ngIf="last">
                          <div class="btn-group">
                            <button type="button" style="margin-top: 31%" class="btn btn-md btn-success dropdown-toggle"
                              data-bs-toggle="dropdown">
                              Action
                            </button>

                            <div class="dropdown-menu">
                              <a (click)="deleteaddress(idx)" class="dropdown-item" *ngIf="
                                  idx != 0 && idx != count1 - 1 && last == true
                                ">
                                <i title="Edit Complaint" class="ion-android-delete"></i>&nbsp;Delete</a>
                              <a (click)="addaddress()" class="dropdown-item" *ngIf="last">
                                <i title="Edit Complaint" class="ion-ios-plus-outline"></i>&nbsp;ADD</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </nb-tab>
          </nb-tabset>
        </div>

        <div class="modal-footer">
          <button type="submit" status="success" nbButton>Add</button>
          <button type="button" class="btn btn-md btn-danger" [routerLink]="['/pages/vendor/ListVendor']">
            Back
          </button>
        </div>
      </form>
    </nb-card-body>
  </nb-card>
</div>